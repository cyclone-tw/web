# PDF 工具箱 v5 使用手冊

> 🎉 **v5 新功能**：支援拖曳排序！自由調整 PDF 頁面合併順序

---

## 📋 目錄

1. [功能總覽](#功能總覽)
2. [合併 PDF（含拖曳排序）](#合併-pdf含拖曳排序)
3. [分割 PDF](#分割-pdf)
4. [常見問題](#常見問題)
5. [更新日誌](#更新日誌)

---

## 🎯 功能總覽

### ✨ v5 版本亮點

| 功能 | 說明 | 新增 |
|------|------|------|
| **拖曳排序** | 可視化調整頁面合併順序 | ✅ |
| **雙欄佈局** | 左側選頁面，右側排順序 | ✅ |
| **即時預覽** | 顯示合併後的頁碼順序 | ✅ |
| 多檔案合併 | 支援批次上傳多個 PDF | ✅ |
| 頁面選擇 | 核取框選擇特定頁面 | ✅ |
| 多檔案分割 | 支援批次拆分多個 PDF | ✅ |
| 瀏覽器執行 | 無需上傳伺服器，資料不外流 | ✅ |

---

## 📋 合併 PDF（含拖曳排序）

### 🚀 使用流程

```
1️⃣ 上傳 PDF 檔案
   ↓
2️⃣ 選擇要合併的頁面
   ↓
3️⃣ 拖曳調整合併順序
   ↓
4️⃣ 點擊合併按鈕
   ↓
5️⃣ 下載合併後的 PDF
```

### 📖 詳細步驟

#### **步驟 1：上傳 PDF 檔案**

**方法 A：拖曳上傳**
- 直接將多個 PDF 檔案拖曳到上傳區域

**方法 B：點擊選擇**
- 點擊上傳區域 → 選擇檔案 → 可按住 `Ctrl` 多選

![上傳提示]
```
📁
拖曳 PDF 檔案到這裡
或點擊選擇檔案（支援多個檔案）
```

---

#### **步驟 2：選擇要合併的頁面**

上傳完成後，畫面會分成**左右兩欄**：

```
┌─────────────────────┬──────────────────┐
│  左側：檔案列表      │  右側：排序預覽   │
│                     │                  │
│  ☑ 報告.pdf         │  📋 合併順序      │
│    ☑ 第 1 頁        │                  │
│    ☑ 第 2 頁        │  1️⃣ [縮圖] 報告 p1 │
│    ☐ 第 3 頁        │  2️⃣ [縮圖] 報告 p2 │
│                     │  3️⃣ [縮圖] 附件 p1 │
│  ☑ 附件.pdf         │                  │
│    ☑ 第 1 頁        │  ⬆⬇ 可拖曳排序    │
│    ☐ 第 2 頁        │                  │
└─────────────────────┴──────────────────┘
```

**選擇方式：**
- **點擊頁面卡片**：切換選取/取消選取
- **點擊核取框**：直接勾選/取消勾選
- **全選此檔**：選擇整個檔案的所有頁面
- **全選按鈕**：選擇所有檔案的所有頁面

---

#### **步驟 3：拖曳調整合併順序** ⭐ 新功能

在右側「📋 合併順序」區域：

1. **查看當前順序**
   - 每個項目顯示序號（1, 2, 3...）
   - 顯示檔案名稱和原始頁碼
   - 顯示頁面縮圖預覽

2. **拖曳調整順序**
   - 滑鼠按住任意排序項目
   - 上下拖曳到想要的位置
   - 放開滑鼠完成調整

3. **移除頁面**
   - 點擊項目右側的 `✕` 按鈕
   - 該頁面會從排序列表移除
   - 左側對應頁面會自動取消勾選

**視覺提示：**
- 🖱️ 拖曳時：項目變半透明
- 📍 拖曳到目標位置：藍色邊框提示
- ✅ 放開滑鼠：順序立即更新

---

#### **步驟 4：合併 PDF**

確認順序無誤後：
1. 點擊「🔗 合併選中的頁面」按鈕
2. 等待處理（會顯示進度動畫）
3. 自動下載 `merged.pdf`

---

### 💡 實用技巧

#### 技巧 1：快速重新排序
```
情境：想把最後一頁移到最前面

方法：
1. 在右側排序區找到最後一個項目
2. 拖曳到最上方
3. 完成！
```

#### 技巧 2：跨檔案合併
```
情境：合併 3 個不同 PDF 的特定頁面

範例：
- 報告.pdf（選第 1、3、5 頁）
- 附件 A.pdf（選第 2 頁）
- 附件 B.pdf（選全部）

步驟：
1. 上傳所有檔案
2. 分別勾選需要的頁面
3. 在右側拖曳調整成理想順序
4. 合併！
```

#### 技巧 3：建立自訂頁面組合
```
情境：從 10 頁文件選出 2, 5, 7, 3 頁（非連續）

步驟：
1. 勾選第 2, 5, 7, 3 頁
2. 右側會按勾選順序排列
3. 拖曳調整成 2 → 5 → 7 → 3
4. 合併完成
```

---

### 🎯 使用範例

#### 範例 1：合併會議資料

**需求：**
- 會議議程（議程.pdf，5 頁）
- 財務報表（報表.pdf，10 頁）
- 只要議程第 1 頁 + 報表第 3-5 頁

**操作：**
```
1. 上傳「議程.pdf」和「報表.pdf」
2. 左側勾選：
   ✅ 議程.pdf → 第 1 頁
   ✅ 報表.pdf → 第 3, 4, 5 頁
3. 右側顯示：
   1️⃣ 議程 - 第 1 頁
   2️⃣ 報表 - 第 3 頁
   3️⃣ 報表 - 第 4 頁
   4️⃣ 報表 - 第 5 頁
4. 如果想改成「報表 3→議程 1→報表 4→報表 5」
   → 拖曳「議程 - 第 1 頁」到第 2 位
5. 點擊合併
```

#### 範例 2：重新排序投影片

**需求：**
- 簡報.pdf（20 頁）
- 想要重新排序成：第 1, 5, 10, 15, 20 頁

**操作：**
```
1. 上傳「簡報.pdf」
2. 點擊「取消全選」
3. 逐一勾選第 1, 5, 10, 15, 20 頁
4. 右側會顯示這 5 頁（按勾選順序）
5. 如需調整順序，直接拖曳
6. 合併完成
```

#### 範例 3：插入封面和封底

**需求：**
- 封面.pdf（1 頁）
- 內容.pdf（8 頁）
- 封底.pdf（1 頁）

**操作：**
```
1. 依序上傳：封面.pdf → 內容.pdf → 封底.pdf
2. 預設會全選，右側順序應該是：
   1️⃣ 封面 - 第 1 頁
   2️⃣ 內容 - 第 1-8 頁
   3️⃣ 封底 - 第 1 頁
3. 如順序正確，直接合併
4. 如需調整，拖曳即可
```

---

### 🎨 介面說明

#### 左側：檔案列表區

```
┌─────────────────────────────────────┐
│ 📄 報告.pdf (3 / 5 頁已選)          │
│ ┌─────┐  ┌─────┐  ┌─────┐          │
│ │ ☑️  │  │ ☑️  │  │ ☐  │          │
│ │[圖] │  │[圖] │  │[圖] │          │
│ │第1頁│  │第2頁│  │第3頁│          │
│ └─────┘  └─────┘  └─────┘          │
│                                     │
│ [全選此檔] [取消全選] [🗑️ 刪除]     │
└─────────────────────────────────────┘
```

- **頁面卡片**：點擊切換選取狀態
- **核取框**：勾選/取消勾選
- **藍色邊框**：已選取的頁面
- **檔案操作**：快速選取或刪除整個檔案

#### 右側：排序預覽區

```
┌──────────────────────────────────┐
│ 📋 合併順序          5 頁        │
│ ─────────────────────────────── │
│                                  │
│ 1  [縮圖] 報告.pdf - 第 1 頁  ✕  │
│ 2  [縮圖] 報告.pdf - 第 2 頁  ✕  │
│ 3  [縮圖] 附件.pdf - 第 1 頁  ✕  │
│ 4  [縮圖] 附件.pdf - 第 3 頁  ✕  │
│ 5  [縮圖] 報告.pdf - 第 5 頁  ✕  │
│                                  │
│ ⬆⬇ 拖曳調整順序                 │
└──────────────────────────────────┘
```

- **序號**：合併後的頁碼
- **縮圖**：頁面預覽
- **檔案資訊**：來源檔案和原始頁碼
- **✕ 按鈕**：移除此頁面
- **拖曳**：按住項目上下移動

#### 頂部統計區

```
┌──────────────────────────────────┐
│   5        8        12           │
│ 總檔案數  已選頁數  總頁數        │
└──────────────────────────────────┘
```

#### 控制按鈕

```
[✓ 全選] [✗ 取消全選] [🔗 合併選中的頁面] [🗑️ 清空所有]
```

---

## ✂️ 分割 PDF

### 功能說明

將 PDF 拆分成獨立檔案，支援兩種模式：
1. **拆分為獨立單頁**：每頁單獨成一個 PDF
2. **合併為單一檔案**：選中的頁面合成一個 PDF

### 使用步驟

#### 步驟 1：上傳 PDF
- 拖曳或點擊選擇要拆分的 PDF 檔案
- 支援同時上傳多個檔案

#### 步驟 2：選擇頁面
- 勾選要提取的頁面
- 可使用「全選」快速選取

#### 步驟 3：選擇拆分模式

**模式 1：拆分為獨立單頁**
```
情境：將 5 頁 PDF 拆成 5 個獨立檔案

選擇：○ 拆分為獨立單頁
結果：
  - 報告_page001.pdf
  - 報告_page002.pdf
  - 報告_page003.pdf
  - 報告_page004.pdf
  - 報告_page005.pdf
```

**模式 2：合併為單一檔案**
```
情境：提取第 2, 5, 8 頁合成一個新 PDF

選擇：○ 合併為單一檔案
結果：
  - extracted_pages.pdf（包含原本的第 2, 5, 8 頁）
```

#### 步驟 4：開始拆分
- 點擊「✂️ 開始拆分」按鈕
- 等待處理完成
- 自動下載拆分後的檔案

---

### 使用範例

#### 範例 1：提取特定頁面
```
需求：從 20 頁講義提取第 5, 10, 15 頁

操作：
1. 上傳「講義.pdf」
2. 點擊「取消全選」
3. 勾選第 5, 10, 15 頁
4. 選擇「合併為單一檔案」
5. 點擊拆分
6. 下載 extracted_pages.pdf（3 頁）
```

#### 範例 2：拆分成單頁
```
需求：將合約（5 頁）拆成 5 個獨立檔案

操作：
1. 上傳「合約.pdf」
2. 保持全選狀態
3. 選擇「拆分為獨立單頁」
4. 點擊拆分
5. 下載 5 個檔案：
   - 合約_page001.pdf
   - 合約_page002.pdf
   - 合約_page003.pdf
   - 合約_page004.pdf
   - 合約_page005.pdf
```

---

## ❓ 常見問題

### Q1：為什麼拖曳時頁面會消失？
**A**：這是正常的視覺效果。拖曳時項目會變半透明，放開後就會恢復。

### Q2：可以同時拖曳多個頁面嗎？
**A**：目前只支援單個拖曳。如需移動多個頁面，請逐一拖曳。

### Q3：合併後的 PDF 可以再次編輯嗎？
**A**：可以！下載後可以重新上傳到本工具，繼續編輯。

### Q4：支援的最大檔案數量和大小？
**A**：
- 檔案數量：無限制
- 單一檔案大小：取決於瀏覽器記憶體（建議 < 100MB）
- 總頁數：建議 < 500 頁

### Q5：為什麼有些 PDF 無法上傳？
**A**：可能原因：
- 檔案損壞
- 檔案有密碼保護
- 檔案不是標準 PDF 格式

**解決方法**：
- 使用 Adobe Acrobat 或其他工具修復 PDF
- 移除密碼保護後再上傳

### Q6：檔案會上傳到伺服器嗎？
**A**：不會！所有處理都在您的瀏覽器本地完成，檔案不會外流。

### Q7：可以在手機上使用嗎？
**A**：可以，但建議使用電腦以獲得更好的拖曳體驗。

### Q8：合併後的 PDF 品質會下降嗎？
**A**：不會！本工具使用無損合併，完全保留原始品質。

---

## 🆕 更新日誌

### v5.0 (2025-10-13) - 拖曳排序版
**新增：**
- ✨ 支援拖曳排序功能
- ✨ 雙欄佈局（檔案列表 + 排序預覽）
- ✨ 即時顯示合併順序
- ✨ 視覺化排序介面
- ✨ 可從排序列表移除頁面

**改進：**
- 🎨 優化頁面選取邏輯
- 🎨 改進響應式設計
- 🐛 修復頁面順序同步問題

### v4.0 - 多檔案支援版
**新增：**
- 支援同時上傳多個 PDF
- 分割模式支援批次處理
- 新增檔案管理功能

### v3.0 - 頁面選擇版
**新增：**
- 支援選擇特定頁面合併
- 頁面預覽縮圖
- 跨檔案頁面選擇

### v2.0 - 分割功能版
**新增：**
- 分割 PDF 功能
- 獨立單頁/合併單檔兩種模式

### v1.0 - 初始版本
**功能：**
- 基本 PDF 合併功能

---

## 💻 技術規格

### 系統需求
- **瀏覽器**：Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **記憶體**：建議 4GB 以上
- **網路**：首次載入需要網路（載入 PDF.js 和 PDF-Lib）

### 使用的開源套件
- **PDF.js** v3.11.174：PDF 渲染和預覽
- **PDF-Lib** v1.17.1：PDF 編輯和合併

### 瀏覽器相容性
| 瀏覽器 | 版本 | 支援 |
|--------|------|------|
| Chrome | 90+ | ✅ 完整支援 |
| Firefox | 88+ | ✅ 完整支援 |
| Safari | 14+ | ✅ 完整支援 |
| Edge | 90+ | ✅ 完整支援 |
| IE | 任何版本 | ❌ 不支援 |

---

## 📞 回饋與支援

**遇到問題？**
1. 檢查瀏覽器是否為最新版本
2. 確認檔案格式是否為標準 PDF
3. 嘗試清除瀏覽器快取

**功能建議？**
歡迎提供功能建議或改進意見！

---

## 📄 授權

本工具完全免費使用，基於開源套件開發。

---

**最後更新**：2025-10-13
**版本**：v5.0
**作者**：PDF Tools Team
